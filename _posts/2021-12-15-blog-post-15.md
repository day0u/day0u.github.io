---
title: 'rsa-ctf'
date: 2021-12-15
permalink: /posts/2021/15/blog-post-15/
tags:
  - rsa
---

### RSA基本算法
```
公钥KU	
n：两素数p和q的乘积（p和q必须保密）（n为模值）
e：与(p-1)*(q-1)互质（e称为公钥指数）
私钥KR	
n：两素数p和q的乘积（p和q必须保密）（n为模值）
d：满足(d*e) mod ((p-1)*(q-1)) = 1（d称为私钥指数）
```
```
加密过程	C=M^e mod n  （C为密文）
解密过程	M=C^d mod n  （M为明文）
其中，符号^表示数学上的指数运算；mod表示模运算，即相除取余数。具体算法步骤如下：
（1）选择一对不同的、足够大的素数p，q。
（2）计算n=p*q。
（3）计算f(n)=(p-1)*(q-1)，同时对p, q严加保密，不让任何人知道。
（4）找一个与f(n)互质的数e作为公钥指数，且1<e<f(n)。
（5）计算私钥指数d，使得d满足(d*e) mod f(n) = 1
（6）公钥KU=(e,n)，私钥KR=(d,n)。
（7）加密时，先将明文变换成0至n-1的一个整数M。若明文较长，可先分割成适当的组，然后再进行交换。设密文为C，则加密过程为：C=M^e mod n。
（8）解密过程为：M=C^d mod n。 
```
### 案例代码
```
p =  9648423029010515676590551740010426534945737639235739800643989352039852507298491399561035009163427050370107570733633350911691280297777160200625281665378483
q =  11874843837980297032092405848653656852760910154543380907650040190704283358909208578251063047732443992230647903887510065547947313543299303261986053486569407
e =  65537
c =  83208298995174604174773590298203639360540024871256126892889661345742403314929861939100492666605647316646576486526217457006376842280869728581726746401583705899941768214138742259689334840735633553053887641847651173776251820293087212885670180367406807406765923638973161375817392737747832762751690104423869019034
from gmpy2 import *
d=invert(e,(q-1)*(p-1))
n=mul(p,q)
a=powmod(c,d,n)
b=hex(a)[2:].decode('hex') //此行代码将hex转为字符串输出
print(a,b)
```


