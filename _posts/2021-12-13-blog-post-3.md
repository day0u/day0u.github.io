---
title: '恶意软件分析工具'
date: 2021-12-13
permalink: /posts/2021/13/blog-post-3/
tags:
  - 网马
---

## 网马分析工具

+ Freshow：网马解密工具
+ Mdecoder：网马解密工具，支持URL自动递归分析
+ malzilla：功能全面（复杂）

## 进程钩子

### Detours Hook(Microsoft开发一个库)
1. 它具有两方面的功能：
```
	 拦截x86机器上的任意的win32 API函数。
	 插入任意的数据段到PE文件中，修改DLL文件的导入表。
```
2. Detours 使得应用程序开发人员对应用程序和操作系统的修改变得更容易
3. 恶意代码用来在磁盘上有的二进制文件中挂载新的dll
4. 修改PE结构添加一个 .detour 段 • 包含原始的PE头和一个新的导入地址表
5. setdll 是微软提供的工具，用来使PE指向新的导入表
6. 下图notepad.exe的detour段的导入表包含evil.dll
7. 无论notepad何时启动，evil.dll都会被加载

![detours](https://raw.githubusercontent.com/day0u/day0u.github.io/main/images/_posts/3/detours.png)

### 查看进程注入
+ XueTr
+ ProcessExplorer
